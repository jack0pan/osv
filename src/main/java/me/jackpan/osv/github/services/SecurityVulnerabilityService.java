package me.jackpan.osv.github.services;

import lombok.RequiredArgsConstructor;
import me.jackpan.osv.github.models.SecurityVulnerabilityConnection;
import org.springframework.graphql.client.HttpGraphQlClient;
import org.springframework.stereotype.Service;
import reactor.core.publisher.Mono;

@RequiredArgsConstructor
@Service
public class SecurityVulnerabilityService {
    private final HttpGraphQlClient httpGraphQlClient;

    public Mono<SecurityVulnerabilityConnection> listSecurityVulnerabilities(Integer first, String cursor) {
        return httpGraphQlClient.documentName("listSecurityVulnerabilities")
                .variable("first", first)
                .variable("cursor", cursor)
                .retrieve("securityVulnerabilities")
                .toEntity(SecurityVulnerabilityConnection.class);
    }

    public Mono<SecurityVulnerabilityConnection> countSecurityVulnerabilities() {
        return httpGraphQlClient.documentName("countSecurityVulnerabilities")
                .retrieve("securityVulnerabilities")
                .toEntity(SecurityVulnerabilityConnection.class);
    }
}
